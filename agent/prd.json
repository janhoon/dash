[
  {
    "category": "Setup - Project Architecture & Foundation",
    "description": "Initialize Vue.js 3, Go API, and PostgreSQL foundation for the Grafana-like dashboard application.",
    "tech_stack": {
      "frontend": "Vue.js 3 (Composition API + TypeScript)",
      "backend": "Go API",
      "database": "PostgreSQL (metadata only)",
      "data_source": "Prometheus"
    },
    "steps": [
      "Create frontend/ directory and initialize Vue.js 3 project with TypeScript",
      "Setup Vite for frontend dev server (port 5173)",
      "Create backend/ directory and initialize Go module (go mod init)",
      "Setup Go project structure: cmd/, internal/ (handlers, models, db), pkg/",
      "Create docker-compose.yml: PostgreSQL + Prometheus services",
      "Create PostgreSQL schema migrations (dashboards, panels, data_sources tables)",
      "Setup database connection in Go (use pgx or similar)",
      "Add CORS middleware to Go API",
      "Create health check endpoint: GET /api/health",
      "Add README.md with setup instructions",
      "Add .gitignore for Go, Node, and IDE files",
      "TEST: Vue.js dev server runs on :5173",
      "TEST: Go API runs on :8080",
      "TEST: PostgreSQL container starts and migrations apply",
      "TEST: GET /api/health returns 200 OK"
    ],
    "passes": true
  },
  {
    "category": "Core - Dashboard CRUD Operations",
    "description": "Full CRUD operations for dashboards with list view, create, edit, and delete functionality.",
    "database_schema": {
      "table": "dashboards",
      "columns": [
        "id UUID PRIMARY KEY",
        "title VARCHAR(255) NOT NULL",
        "description TEXT",
        "created_at TIMESTAMP DEFAULT NOW()",
        "updated_at TIMESTAMP DEFAULT NOW()",
        "user_id VARCHAR(255)"
      ]
    },
    "steps": [
      "Create dashboards table migration in backend/migrations/",
      "Create Dashboard model in internal/models/dashboard.go",
      "Implement POST /api/dashboards handler (create dashboard)",
      "Implement GET /api/dashboards handler (list all dashboards)",
      "Implement GET /api/dashboards/:id handler (get single dashboard)",
      "Implement PUT /api/dashboards/:id handler (update dashboard)",
      "Implement DELETE /api/dashboards/:id handler (delete dashboard)",
      "Frontend: Create DashboardList.vue component",
      "Frontend: Create CreateDashboardModal.vue component",
      "Frontend: Create EditDashboardModal.vue component",
      "Frontend: Add delete confirmation dialog",
      "Frontend: Setup Vue Router with /dashboards route",
      "Frontend: Create API client functions for dashboard CRUD",
      "TEST: POST /api/dashboards creates dashboard and returns 201",
      "TEST: GET /api/dashboards returns list of all dashboards",
      "TEST: PUT /api/dashboards/:id updates title/description",
      "TEST: DELETE /api/dashboards/:id removes dashboard and returns 204",
      "TEST: Frontend displays dashboard list and allows create/edit/delete"
    ],
    "passes": true
  },
  {
    "category": "Core - Panel System (Simple Container)",
    "description": "Panel system for visualizations - simple container with CRUD operations and 12-column grid positioning.",
    "database_schema": {
      "table": "panels",
      "columns": [
        "id UUID PRIMARY KEY",
        "dashboard_id UUID REFERENCES dashboards(id) ON DELETE CASCADE",
        "title VARCHAR(255) NOT NULL",
        "type VARCHAR(50) DEFAULT 'line_chart'",
        "grid_pos JSONB NOT NULL",
        "query JSONB",
        "created_at TIMESTAMP DEFAULT NOW()",
        "updated_at TIMESTAMP DEFAULT NOW()"
      ]
    },
    "steps": [
      "Create panels table migration with foreign key to dashboards",
      "Create Panel model in internal/models/panel.go",
      "Implement POST /api/dashboards/:id/panels handler (create panel)",
      "Implement GET /api/dashboards/:id/panels handler (list panels for dashboard)",
      "Implement PUT /api/panels/:id handler (update panel)",
      "Implement DELETE /api/panels/:id handler (delete panel)",
      "Frontend: Create Panel.vue component (simple card with title + content slot)",
      "Frontend: Add 'Add Panel' button on dashboard view",
      "Frontend: Create PanelEditModal.vue for editing panel title/query",
      "Frontend: Add delete panel action with confirmation",
      "Frontend: Create API client functions for panel CRUD",
      "TEST: POST /api/dashboards/:id/panels creates panel with grid_pos",
      "TEST: GET /api/dashboards/:id/panels returns all panels for dashboard",
      "TEST: PUT /api/panels/:id updates panel title and query",
      "TEST: DELETE /api/panels/:id removes panel",
      "TEST: Frontend renders panels as simple cards on dashboard"
    ],
    "passes": true
  },
  {
    "category": "UI - Time Range Picker Component",
    "description": "Global time range selector with presets, custom range, and auto-refresh toggle.",
    "presets": [
      "Last 5 minutes",
      "Last 15 minutes",
      "Last 30 minutes",
      "Last 1 hour",
      "Last 6 hours",
      "Last 24 hours",
      "Last 7 days",
      "Custom (from/to datetime pickers)"
    ],
    "steps": [
      "Create useTimeRange.ts composable with reactive start/end timestamps",
      "Create TimeRangePicker.vue component with dropdown UI",
      "Add preset range options (5m, 15m, 30m, 1h, 6h, 24h, 7d)",
      "Add custom range option with from/to datetime pickers",
      "Implement auto-refresh toggle with intervals: 5s, 15s, 30s, 1m",
      "Display current range as human-readable text (e.g., 'Last 5 minutes')",
      "Store selected range in dashboard state (not persisted to DB)",
      "Ensure all panels use the same time range from shared state",
      "Add refresh button for manual refresh",
      "TEST: Select 'Last 5 minutes' → start/end timestamps calculated correctly",
      "TEST: Custom range → from/to datetime pickers work",
      "TEST: Time range updates trigger panel re-fetch",
      "TEST: Auto-refresh at 5s interval triggers panel updates"
    ],
    "passes": true
  },
  {
    "category": "Data - Prometheus Data Source Integration",
    "description": "Backend integration with Prometheus using Go client library for querying metrics.",
    "steps": [
      "Add Prometheus Go client dependency: go get github.com/prometheus/client_golang",
      "Create data_sources table migration (id, name, type, url, config JSONB)",
      "Create DataSource model in internal/models/datasource.go",
      "Implement Prometheus client wrapper in pkg/prometheus/",
      "Create GET /api/datasources/prometheus/query endpoint",
      "Query endpoint accepts: query (PromQL), start (unix timestamp), end (unix timestamp), step (interval)",
      "Execute PromQL query via Prometheus API and return results",
      "Return JSON format: {status, data: {resultType, result: [{metric, values}]}}",
      "Handle Prometheus API errors and return appropriate HTTP status codes",
      "Frontend: Create useProm.ts composable for fetching data from API",
      "Frontend: Handle loading and error states in useProm",
      "Frontend: Transform Prometheus response to chart-friendly format",
      "Add Prometheus URL to .env and docker-compose.yml",
      "TEST: Query 'up' metric via API → returns data",
      "TEST: Invalid PromQL query → returns 400 error with message",
      "TEST: Frontend useProm composable fetches and transforms data correctly"
    ],
    "passes": false
  },
  {
    "category": "UI - PromQL Query Editor",
    "description": "Simple query editor for PromQL with validation and query preview.",
    "steps": [
      "Create QueryEditor.vue component with textarea for PromQL input",
      "Add 'Run Query' button to test query before saving",
      "Display query validation feedback (errors from Prometheus API)",
      "Show query results preview below editor (table or raw JSON)",
      "Display metric labels from query result",
      "Save query to panel config when panel is saved",
      "Add syntax highlighting (optional: CodeMirror or Monaco editor)",
      "Integrate QueryEditor into PanelEditModal",
      "TEST: Type 'up' → run query → shows results preview",
      "TEST: Invalid query → shows error message from API",
      "TEST: Save query → panel stores query in config (database)",
      "TEST: Edit panel → query editor loads saved query"
    ],
    "passes": false
  },
  {
    "category": "Visualization - Line Chart Component",
    "description": "Line chart component for time-series data using ECharts.",
    "charting_library": "Apache ECharts",
    "steps": [
      "Add ECharts dependency: npm install echarts vue-echarts",
      "Create LineChart.vue component with ECharts integration",
      "Component props: data (time-series array), title, height",
      "Configure X-axis: timestamps formatted as HH:mm:ss or date",
      "Configure Y-axis: metric values with auto-scaling",
      "Support multiple series (multiple metrics on one chart)",
      "Add tooltip showing timestamp + value on hover",
      "Add legend for multi-series charts",
      "Apply dark theme to match Grafana aesthetic",
      "Add grid lines for readability",
      "Make chart responsive - fits panel container",
      "Integrate LineChart.vue into Panel.vue component",
      "TEST: Render single metric → line chart displays correctly",
      "TEST: Render multiple metrics → legend shows all series",
      "TEST: Hover over data point → tooltip shows time + value",
      "TEST: Chart resizes when panel is resized"
    ],
    "passes": false
  },
  {
    "category": "Feature - Auto-Refresh for Panels",
    "description": "Auto-refresh panels at configurable intervals (5s, 15s, 30s, etc.).",
    "refresh_intervals": [
      "Off",
      "5s",
      "15s",
      "30s",
      "1m",
      "5m"
    ],
    "steps": [
      "Add refresh interval selector to TimeRangePicker component",
      "Store selected interval in dashboard state (reactive)",
      "Create useAutoRefresh.ts composable",
      "Use setInterval to trigger panel data refresh at selected interval",
      "Clear interval when dashboard unmounts or interval changes",
      "Trigger refetch for all panels when interval fires",
      "Show subtle 'Refreshing...' indicator (spinner or text)",
      "Preserve user's time range selection during refresh",
      "Default refresh to 'Off' (manual refresh only)",
      "Show countdown or last refresh timestamp in UI",
      "Pause auto-refresh when user is editing a panel",
      "TEST: Set 5s refresh → panels query every 5 seconds",
      "TEST: Change to 15s → interval updates correctly",
      "TEST: Set to Off → refresh stops",
      "TEST: Edit panel → auto-refresh pauses"
    ],
    "passes": false
  },
  {
    "category": "UI - Dashboard Grid Layout (12-Column Drag & Drop)",
    "description": "Responsive 12-column grid with drag-and-drop panel positioning using vue-grid-layout.",
    "grid_library": "vue-grid-layout",
    "steps": [
      "Add vue-grid-layout dependency: npm install vue-grid-layout",
      "Import and register GridLayout and GridItem components",
      "Setup 12-column grid system on dashboard view",
      "Each panel has position: {x, y, w, h} stored in grid_pos JSON column",
      "Enable drag-and-drop to reposition panels",
      "Add resize handles on panel corners/edges",
      "Implement collision detection (panels push others out of the way)",
      "Enable compact mode (fill gaps automatically)",
      "Save grid_pos to database on layout change (debounced)",
      "Load saved positions when dashboard opens",
      "Add responsive breakpoints: 12 cols (desktop), 6 cols (tablet), 1 col (mobile)",
      "TEST: Drag panel → position updates in UI and DB",
      "TEST: Resize panel → width/height updates",
      "TEST: Add new panel → appears in available space",
      "TEST: Reload dashboard → panels restore saved positions"
    ],
    "passes": false
  }
]
